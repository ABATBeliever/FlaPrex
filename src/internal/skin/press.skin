<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>{{title}}</title>
  <meta name="viewport"    content="width=device-width, initial-scale=1.0">
  <meta name="description" content="{{description}}">
  <meta name="author"      content="{{author}}">
  <meta name="keywords"    content="{{keyword}}">
  {{robots}}

  <meta property="og:site_name"   content="{{websiteName}}">
  <meta property="og:title"       content="{{title}}">
  <meta property="og:type"        content="article">
  <meta property="og:description" content="{{description}}">
  <meta property="og:image"       content="{{websiteRoot}}/src/media/ogp/{{ogpimg}}">

  <link rel="icon" type="image/x-icon"              href="{{websiteRoot}}/src/media/favicon/favicon.ico">
  <link rel="icon" type="image/png"                 href="{{websiteRoot}}/src/media/favicon/favicon-180.png">
  <link rel="icon" type="image/png" sizes="16x16"   href="{{websiteRoot}}/src/media/favicon/favicon-016.png">
  <link rel="icon" type="image/png" sizes="32x32"   href="{{websiteRoot}}/src/media/favicon/favicon-032.png">
  <link rel="apple-touch-icon"      sizes="180x180" href="{{websiteRoot}}/src/media/favicon/favicon-180.png">
  <link rel="apple-touch-icon"      sizes="512x512" href="{{websiteRoot}}/src/media/favicon/favicon-512.png">
  <link rel="shortcut icon"                         href="{{websiteRoot}}/src/media/favicon/favicon.ico">

  <link rel="stylesheet" href="/src/media/css/article.css">
</head>

<body>
<header>
  <h1><a href="/" style="color: white;">{{websiteName}}</a></h1>
  <div class="hamburger" id="hamburger">
    <span></span>
    <span></span>
    <span></span>
  </div>
  <nav id="nav">
    <a href="#random-news-list">おすすめの記事</a>
    <a href="#latest-news-list">最新の記事</a>
    <a href="#category-list">カテゴリから探す</a>
  </nav>
  <div class="search-box">
    <form method="get" action="/search/">
      <input type="text" name="word" placeholder="検索語...">
      <button type="submit">検索</button>
    </form>
  </div>
</header>

<div class="container">
  <aside class="left">
    <h2>おすすめの記事</h2>
      <ul id="random-news-list"></ul>
      <script>
      fetch("/src/internal/api/recommend.php?cnt=7")
        .then(res => res.json())
        .then(data => {
          const ul = document.getElementById("random-news-list");
          data.forEach(item => {
            const li = document.createElement("li");
            li.innerHTML = `<button><a href="/article/${item.id}/" style="color: white;">${item.title}</a> <small>${item.day}</small></button>`;
            ul.appendChild(li);
          });
        })
        .catch(err => {
            const ul = document.getElementById("random-news-list");
            const li = document.createElement("li");
            li.style.color = "red";
            li.textContent = "取得失敗 recommendAPIが不正です"
            ul.appendChild(li);
        });
      </script>
  </aside>

  <main>
    <h2>{{title}}</h2>
    <p>著者: {{author}}<br>公開: {{day}} / 最終更新: {{update}}</p>
    <br>

{{content}}

  </main>

  <aside class="right">
    <h2>最新の記事</h2>
      <ul id="latest-news-list"></ul>
      <script>
      fetch("/src/internal/api/new.php?cnt=7")
        .then(res => res.json())
        .then(data => {
          const ul = document.getElementById("latest-news-list");
          data.forEach(item => {
            const li = document.createElement("li");
            li.innerHTML = `<button><a href="/article/${item.id}/" style="color: white;">${item.title}</a> <small>${item.update}</small></button>`;
            ul.appendChild(li);
          });
        })
        .catch(err => {
            const ul = document.getElementById("latest-news-list");
            const li = document.createElement("li");
            li.style.color = "red";
            li.textContent = "取得失敗 newAPIが不正です"
            ul.appendChild(li);
        });
      </script>
    <h2>カテゴリから探す</h2>
      <ul id="category-list"></ul>
      <script>
      fetch("/src/internal/api/list-category.php")
        .then(res => res.json())
        .then(data => {
          const ul = document.getElementById("category-list");
          const tags = Object.keys(data);
          tags.forEach(tag => {
            const count = data[tag];
            const li = document.createElement("li");
            li.innerHTML = `<a href="/search/index.php?tag=${encodeURIComponent(tag)}">${tag}</a> <small>(${count})</small>`;
            ul.appendChild(li);
          });
        })
        .catch(err => {
            const ul = document.getElementById("category-list");
            const li = document.createElement("li");
            li.style.color = "red";
            li.textContent = "取得失敗 list-categoryAPIが不正です"
            ul.appendChild(li);
        });
      </script>
  </aside>
</div>

<div style="text-align: center">
  <footer>
    <small>
      {{websiteFooter}}
    </small>
  </footer>
</div>

<script type="text/javascript" src="{{websiteRoot}}/src/media/js/hamburger.js"></script>

</body>
</html>
